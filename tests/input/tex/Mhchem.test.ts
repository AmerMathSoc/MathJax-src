import { beforeEach, describe, it } from '@jest/globals';
import { toXmlMatch } from '../../src/xmlMatch';
import { setupTex, tex2mml } from '../../src/setupTex';

beforeEach(() => setupTex(["base","mhchem"]));

describe('Mhchem0', () => {
  it('Chem-1', () => toXmlMatch(tex2mml("\\ce{CO2 + C -> 2 CO}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{CO2 + C -&gt; 2 CO}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{CO}{\\vphantom{A}}_{\\smash[t]{2}} {}+{} \\mathrm{C} {}\\mathrel{\\longrightarrow}{} 2\\,\\mathrm{CO}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CO\">CO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longrightarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\longrightarrow\">&#x27F6;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mn data-latex=\"2\">2</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CO\">CO</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-3', () => toXmlMatch(tex2mml("C_p[\\ce{H2O(l)}] = \\pu{75.3 J // mol K}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"C_p[\\ce{H2O(l)}] = \\pu{75.3 J // mol K}\" display=\"block\">\n  <msub data-latex=\"C_p\">\n    <mi data-latex=\"C\">C</mi>\n    <mi data-latex=\"p\">p</mi>\n  </msub>\n  <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}\\mskip2mu(\\mathrm{l})}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n    <mspace width=\"0.111em\" data-latex=\"\\mskip2mu\"></mspace>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{l}\">\n      <mi mathvariant=\"normal\" data-latex=\"l\">l</mi>\n    </mrow>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n  <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n  <mo data-latex=\"=\">=</mo>\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{5.3~\\mathchoice{\\textstyle\\frac{\\mathrm{J}}{\\mathrm{mol}\\mkern3mu \\mathrm{K}}}{\\frac{\\mathrm{J}}{\\mathrm{mol}\\mkern3mu \\mathrm{K}}}{\\frac{\\mathrm{J}}{\\mathrm{mol}\\mkern3mu \\mathrm{K}}}{\\frac{\\mathrm{J}}{\\mathrm{mol}\\mkern3mu \\mathrm{K}}}}\">\n    <mn data-latex=\"5.3\">75.3</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mstyle displaystyle=\"false\" scriptlevel=\"0\" data-latex=\"\\textstyle\\frac{\\mathrm{J}}{\\mathrm{mol}\\mkern3mu \\mathrm{K}}\">\n      <mfrac data-latex=\"\\frac{\\mathrm{J}}{\\mathrm{mol}\\mkern3mu \\mathrm{K}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{J}\">\n          <mi mathvariant=\"normal\" data-latex=\"J\">J</mi>\n        </mrow>\n        <mrow data-latex=\"\\mathrm{mol}\\mkern3mu \\mathrm{K}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{mol}\">\n            <mi data-mjx-auto-op=\"false\" data-latex=\"mol\">mol</mi>\n          </mrow>\n          <mspace width=\"0.167em\" linebreak=\"nobreak\" data-latex=\"\\mkern3mu\"></mspace>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{K}\">\n            <mi mathvariant=\"normal\" data-latex=\"K\">K</mi>\n          </mrow>\n        </mrow>\n      </mfrac>\n    </mstyle>\n  </mrow>\n</math>"
  ));
  it('Chem-4', () => toXmlMatch(tex2mml("\\ce{H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-5', () => toXmlMatch(tex2mml("\\ce{Sb2O3}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Sb2O3}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Sb}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}{\\vphantom{A}}_{\\smash[t]{3}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Sb}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Sb\">Sb</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-6', () => toXmlMatch(tex2mml("\\ce{H+}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{H+}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{H}{\\vphantom{A}}^{+}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{+}\">\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-7', () => toXmlMatch(tex2mml("\\ce{CrO4^2-}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{CrO4^2-}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{CrO}{\\vphantom{A}}_{\\smash[t]{4}}{\\vphantom{A}}^{2-}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CrO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CrO\">CrO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <msup data-latex=\"{\\vphantom{A}}^{2-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2-}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-8', () => toXmlMatch(tex2mml("\\ce{[AgCl2]-}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{[AgCl2]-}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{[\\mathrm{AgCl}{\\vphantom{A}}_{\\smash[t]{2}}]{\\vphantom{A}}^{-}}\">\n    <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{AgCl}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"AgCl\">AgCl</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n    <msup data-latex=\"{\\vphantom{A}}^{-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-9', () => toXmlMatch(tex2mml("\\ce{Y^99+}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Y^99+}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Y}{\\vphantom{A}}^{99+}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Y}\">\n      <mi mathvariant=\"normal\" data-latex=\"Y\">Y</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{9+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{9+}\">\n        <mn data-latex=\"9\">99</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem1', () => {
  it('Chem-10', () => toXmlMatch(tex2mml("\\ce{Y^{99+}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Y^{99+}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Y}{\\vphantom{A}}^{99+}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Y}\">\n      <mi mathvariant=\"normal\" data-latex=\"Y\">Y</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{9+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{9+}\">\n        <mn data-latex=\"9\">99</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-11', () => toXmlMatch(tex2mml("\\ce{2 H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{2 H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mn data-latex=\"2\">2</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-12', () => toXmlMatch(tex2mml("\\ce{2H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{2H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mn data-latex=\"2\">2</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-13', () => toXmlMatch(tex2mml("\\ce{0.5 H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{0.5 H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{0.5\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mn data-latex=\".5\">0.5</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-14', () => toXmlMatch(tex2mml("\\ce{1/2 H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{1/2 H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathchoice{\\textstyle\\frac{1}{2}}{\\frac{1}{2}}{\\frac{1}{2}}{\\frac{1}{2}}\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mstyle displaystyle=\"false\" scriptlevel=\"0\" data-latex=\"\\textstyle\\frac{1}{2}\">\n      <mfrac data-latex=\"\\frac{1}{2}\">\n        <mn data-latex=\"1\">1</mn>\n        <mn data-latex=\"2\">2</mn>\n      </mfrac>\n    </mstyle>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-15', () => toXmlMatch(tex2mml("\\ce{(1/2) H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{(1/2) H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{(1/2)\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mn data-latex=\"1\">1</mn>\n    <mrow data-mjx-texclass=\"ORD\">\n      <mo data-latex=\"/\">/</mo>\n    </mrow>\n    <mn data-latex=\"2\">2</mn>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-16', () => toXmlMatch(tex2mml("\\ce{$n$ H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{$n$ H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{n \\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mi data-latex=\"n\">n</mi>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-17', () => toXmlMatch(tex2mml("\\ce{^{227}_{90}Th+}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{^{227}_{90}Th+}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\vphantom{A}}^{\\hphantom{227}}_{\\hphantom{90}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{227}}_{\\vphantom{2}\\llap{\\smash[t]{90}}}\\mathrm{Th}{\\vphantom{A}}^{+}}\">\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{227}}_{\\hphantom{90}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{90}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{90}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"90\">90</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{227}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{227}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"227\">227</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{227}}_{\\vphantom{2}\\llap{\\smash[t]{90}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{90}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{90}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{90}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"90\">90</mn>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{227}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{227}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"227\">227</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Th}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Th\">Th</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{+}\">\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-18', () => toXmlMatch(tex2mml("\\ce{^227_90Th+}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{^227_90Th+}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\vphantom{A}}^{\\hphantom{227}}_{\\hphantom{90}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{227}}_{\\vphantom{2}\\llap{\\smash[t]{90}}}\\mathrm{Th}{\\vphantom{A}}^{+}}\">\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{227}}_{\\hphantom{90}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{90}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{90}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"90\">90</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{227}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{227}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"227\">227</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{227}}_{\\vphantom{2}\\llap{\\smash[t]{90}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{90}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{90}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{90}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"90\">90</mn>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{227}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{227}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"227\">227</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Th}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Th\">Th</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{+}\">\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-19', () => toXmlMatch(tex2mml("\\ce{^{0}_{-1}n^{-}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{^{0}_{-1}n^{-}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\vphantom{A}}^{\\hphantom{0}}_{\\hphantom{-1}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{0}}_{\\vphantom{2}\\llap{\\smash[t]{-1}}}\\mathrm{n}{\\vphantom{A}}^{-}}\">\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{0}}_{\\hphantom{-1}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{-1}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{-1}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mo data-latex=\"-\">&#x2212;</mo>\n              <mn data-latex=\"1\">1</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{0}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{0}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"0\">0</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{0}}_{\\vphantom{2}\\llap{\\smash[t]{-1}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{-1}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{-1}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{-1}\">\n              <mpadded height=\"0\">\n                <mo data-latex=\"-\">&#x2212;</mo>\n                <mn data-latex=\"1\">1</mn>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{0}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{0}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"0\">0</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{n}\">\n      <mi mathvariant=\"normal\" data-latex=\"n\">n</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem2', () => {
  it('Chem-20', () => toXmlMatch(tex2mml("\\ce{^0_-1n-}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{^0_-1n-}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\vphantom{A}}^{\\hphantom{0}}_{\\hphantom{-1}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{0}}_{\\vphantom{2}\\llap{\\smash[t]{-1}}}\\mathrm{n}{\\vphantom{A}}^{-}}\">\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{0}}_{\\hphantom{-1}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{-1}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{-1}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mo data-latex=\"-\">&#x2212;</mo>\n              <mn data-latex=\"1\">1</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{0}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{0}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"0\">0</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{0}}_{\\vphantom{2}\\llap{\\smash[t]{-1}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{-1}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{-1}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{-1}\">\n              <mpadded height=\"0\">\n                <mo data-latex=\"-\">&#x2212;</mo>\n                <mn data-latex=\"1\">1</mn>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{0}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{0}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"0\">0</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{n}\">\n      <mi mathvariant=\"normal\" data-latex=\"n\">n</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-21', () => toXmlMatch(tex2mml("\\ce{H{}^3HO}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{H{}^3HO}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{H}\\mkern2mu{\\vphantom{A}}^{\\hphantom{3}}_{\\hphantom{}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{3}}_{\\vphantom{2}\\llap{\\smash[t]{}}}\\mathrm{HO}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\mkern2mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{3}}_{\\hphantom{}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom></mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{3}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"3\">3</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{3}}_{\\vphantom{2}\\llap{\\smash[t]{}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{}\">\n              <mpadded height=\"0\"></mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{3}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{HO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"HO\">HO</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-22', () => toXmlMatch(tex2mml("\\ce{H^3HO}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{H^3HO}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{H}\\mkern2mu{\\vphantom{A}}^{\\hphantom{3}}_{\\hphantom{}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{3}}_{\\vphantom{2}\\llap{\\smash[t]{}}}\\mathrm{HO}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\mkern2mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{3}}_{\\hphantom{}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom></mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{3}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"3\">3</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{3}}_{\\vphantom{2}\\llap{\\smash[t]{}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{}\">\n              <mpadded height=\"0\"></mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{3}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{HO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"HO\">HO</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-23', () => toXmlMatch(tex2mml("\\ce{A -> B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A -&gt; B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longrightarrow}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longrightarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\longrightarrow\">&#x27F6;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-24', () => toXmlMatch(tex2mml("\\ce{A <- B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A &lt;- B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longleftarrow}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longleftarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\longleftarrow\">&#x27F5;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-25', () => toXmlMatch(tex2mml("\\ce{A <-> B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A &lt;-&gt; B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longleftrightarrow}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longleftrightarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\longleftrightarrow\">&#x27F7;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-26', () => toXmlMatch(tex2mml("\\ce{A <--> B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A &lt;--&gt; B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longleftrightarrows}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longleftrightarrows}\">\n      <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\mathop{\\smash{\\longleftarrow}\\Rule{0px}{.25em}{0px}}\\limits^{\\longrightarrow}}\">\n        <mover data-latex=\"\\mathop{\\smash{\\longleftarrow}\\Rule{0px}{.25em}{0px}}\\limits^{\\longrightarrow}\">\n          <mrow data-mjx-texclass=\"OP\" data-latex=\"\\limits\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash{\\longleftarrow}\">\n              <mpadded height=\"0\" depth=\"0\">\n                <mo stretchy=\"false\" data-latex=\"\\longleftarrow\">&#x27F5;</mo>\n              </mpadded>\n            </mrow>\n            <mspace width=\"0px\" height=\".25em\" depth=\"0px\" mathbackground=\"black\" data-latex=\"\\Rule{0px}{.25em}{0px}\"></mspace>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\longrightarrow}\">\n            <mo stretchy=\"false\" data-latex=\"\\longrightarrow\">&#x27F6;</mo>\n          </mrow>\n        </mover>\n      </mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-27', () => toXmlMatch(tex2mml("\\ce{A <=> B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A &lt;=&gt; B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longrightleftharpoons}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longrightleftharpoons}\">\n      <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}}\">\n        <mover data-latex=\"\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}\">\n          <mrow data-mjx-texclass=\"OP\" data-latex=\"\\limits\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash{{\\leftharpoondown}\\!\\!{-}}\">\n              <mpadded height=\"0\" depth=\"0\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\leftharpoondown}\">\n                  <mo stretchy=\"false\" data-latex=\"\\leftharpoondown\">&#x21BD;</mo>\n                </mrow>\n                <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                  <mspace width=\"-0.167em\"></mspace>\n                </mstyle>\n                <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                  <mspace width=\"-0.167em\"></mspace>\n                </mstyle>\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                  <mo data-latex=\"-\">&#x2212;</mo>\n                </mrow>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\">\n            <mstyle displaystyle=\"false\" scriptlevel=\"0\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                <mo data-latex=\"-\">&#x2212;</mo>\n              </mrow>\n              <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                <mspace width=\"-0.167em\"></mspace>\n              </mstyle>\n              <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                <mspace width=\"-0.167em\"></mspace>\n              </mstyle>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rightharpoonup}\">\n                <mo stretchy=\"false\" data-latex=\"\\rightharpoonup\">&#x21C0;</mo>\n              </mrow>\n            </mstyle>\n          </mrow>\n        </mover>\n      </mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-28', () => toXmlMatch(tex2mml("\\ce{A <=>> B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A &lt;=&gt;&gt; B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longRightleftharpoons}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longRightleftharpoons}\">\n      <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\mathop{\\smash{\\leftharpoondown}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}}\">\n        <mover data-latex=\"\\mathop{\\smash{\\leftharpoondown}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}\">\n          <mrow data-mjx-texclass=\"OP\" data-latex=\"\\limits\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash{\\leftharpoondown}\">\n              <mpadded height=\"0\" depth=\"0\">\n                <mo stretchy=\"false\" data-latex=\"\\leftharpoondown\">&#x21BD;</mo>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\">\n            <mstyle displaystyle=\"false\" scriptlevel=\"0\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                <mo data-latex=\"-\">&#x2212;</mo>\n              </mrow>\n              <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                <mspace width=\"-0.167em\"></mspace>\n              </mstyle>\n              <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                <mspace width=\"-0.167em\"></mspace>\n              </mstyle>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rightharpoonup}\">\n                <mo stretchy=\"false\" data-latex=\"\\rightharpoonup\">&#x21C0;</mo>\n              </mrow>\n            </mstyle>\n          </mrow>\n        </mover>\n      </mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-29', () => toXmlMatch(tex2mml("\\ce{A <<=> B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A &lt;&lt;=&gt; B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\longLeftrightharpoons}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longLeftrightharpoons}\">\n      <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle\\vphantom{{-}}{\\rightharpoonup}}}\">\n        <mover data-latex=\"\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle\\vphantom{{-}}{\\rightharpoonup}}\">\n          <mrow data-mjx-texclass=\"OP\" data-latex=\"\\limits\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash{{\\leftharpoondown}\\!\\!{-}}\">\n              <mpadded height=\"0\" depth=\"0\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\leftharpoondown}\">\n                  <mo stretchy=\"false\" data-latex=\"\\leftharpoondown\">&#x21BD;</mo>\n                </mrow>\n                <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                  <mspace width=\"-0.167em\"></mspace>\n                </mstyle>\n                <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                  <mspace width=\"-0.167em\"></mspace>\n                </mstyle>\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                  <mo data-latex=\"-\">&#x2212;</mo>\n                </mrow>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\">\n            <mstyle displaystyle=\"false\" scriptlevel=\"0\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{{-}}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                      <mo data-latex=\"-\">&#x2212;</mo>\n                    </mrow>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rightharpoonup}\">\n                <mo stretchy=\"false\" data-latex=\"\\rightharpoonup\">&#x21C0;</mo>\n              </mrow>\n            </mstyle>\n          </mrow>\n        </mover>\n      </mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem3', () => {
  it('Chem-33', () => toXmlMatch(tex2mml("\\ce{(NH4)2S}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{(NH4)2S}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{(\\mathrm{NH}{\\vphantom{A}}_{\\smash[t]{4}}){\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{S}}\">\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NH\">NH</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{S}\">\n      <mi mathvariant=\"normal\" data-latex=\"S\">S</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-34', () => toXmlMatch(tex2mml("\\ce{[\\{(X2)3\\}2]^3+}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{[\\{(X2)3\\}2]^3+}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{[\\{(\\mathrm{X}{\\vphantom{A}}_{\\smash[t]{2}}){\\vphantom{A}}_{\\smash[t]{3}}\\}{\\vphantom{A}}_{\\smash[t]{2}}]{\\vphantom{A}}^{3+}}\">\n    <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n    <mo fence=\"false\" stretchy=\"false\" data-latex=\"\\{\">{</mo>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{X}\">\n      <mi mathvariant=\"normal\" data-latex=\"X\">X</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo fence=\"false\" stretchy=\"false\" data-latex=\"\\}\">}</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n    <msup data-latex=\"{\\vphantom{A}}^{3+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{3+}\">\n        <mn data-latex=\"3\">3</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-35', () => toXmlMatch(tex2mml("\\ce{CH4 + 2 $\\left( \\ce{O2 + 79/21 N2} \\right)$}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{CH4 + 2 $\\left( \\ce{O2 + 79/21 N2} \\right)$}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{CH}{\\vphantom{A}}_{\\smash[t]{4}} {}+{} 2\\,\\left(  \\mathrm{O}{\\vphantom{A}}_{\\smash[t]{2}} {}+{} \\mathchoice{\\textstyle\\frac{79}{21}}{\\frac{79}{21}}{\\frac{79}{21}}{\\frac{79}{21}}\\,\\mathrm{N}{\\vphantom{A}}_{\\smash[t]{2}} \\right) }\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CH\">CH</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mn data-latex=\"2\">2</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"INNER\" data-latex-item=\"\\left(  \\mathrm{O}{\\vphantom{A}}_{\\smash[t]{2}} {}+{} \\mathchoice{\\textstyle\\frac{79}{21}}{\\frac{79}{21}}{\\frac{79}{21}}{\\frac{79}{21}}\\,\\mathrm{N}{\\vphantom{A}}_{\\smash[t]{2}} \\right)\" data-latex=\"\\left(  \\mathrm{O}{\\vphantom{A}}_{\\smash[t]{2}} {}+{} \\mathchoice{\\textstyle\\frac{79}{21}}{\\frac{79}{21}}{\\frac{79}{21}}{\\frac{79}{21}}\\,\\mathrm{N}{\\vphantom{A}}_{\\smash[t]{2}} \\right)\">\n      <mo data-mjx-texclass=\"OPEN\" data-latex-item=\"\\left(\" data-latex=\"\\left(\">(</mo>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n        <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n      </mrow>\n      <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n            <mpadded width=\"0\">\n              <mphantom>\n                <mi data-latex=\"A\">A</mi>\n              </mphantom>\n            </mpadded>\n          </mrow>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n            <mpadded height=\"0\">\n              <mn data-latex=\"2\">2</mn>\n            </mpadded>\n          </mrow>\n        </mrow>\n      </msub>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n      <mo data-latex=\"+\">+</mo>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n      <mstyle displaystyle=\"false\" scriptlevel=\"0\" data-latex=\"\\textstyle\\frac{79}{21}\">\n        <mfrac data-latex=\"\\frac{79}{21}\">\n          <mn data-latex=\"79\">79</mn>\n          <mn data-latex=\"21\">21</mn>\n        </mfrac>\n      </mstyle>\n      <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n        <mspace width=\"0.167em\"></mspace>\n      </mstyle>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{N}\">\n        <mi mathvariant=\"normal\" data-latex=\"N\">N</mi>\n      </mrow>\n      <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n            <mpadded width=\"0\">\n              <mphantom>\n                <mi data-latex=\"A\">A</mi>\n              </mphantom>\n            </mpadded>\n          </mrow>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n            <mpadded height=\"0\">\n              <mn data-latex=\"2\">2</mn>\n            </mpadded>\n          </mrow>\n        </mrow>\n      </msub>\n      <mo data-mjx-texclass=\"CLOSE\" data-latex-item=\"\\right)\" data-latex=\"\\right)\">)</mo>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-36', () => toXmlMatch(tex2mml("\\ce{H2(aq)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{H2(aq)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mskip2mu (\\mathrm{aq})}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mspace width=\"0.111em\" data-latex=\"\\mskip2mu\"></mspace>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{aq}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"aq\">aq</mi>\n    </mrow>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n</math>"
  ));
  it('Chem-37', () => toXmlMatch(tex2mml("\\ce{CO3^2-_{(aq)}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{CO3^2-_{(aq)}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{CO}{\\vphantom{A}}_{\\smash[t]{3}}{\\vphantom{A}}^{2-}{\\vphantom{A}}_{\\smash[t]{\\mskip1mu (\\mathrm{aq})}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CO\">CO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <msup data-latex=\"{\\vphantom{A}}^{2-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2-}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{\\mskip1mu (\\mathrm{aq})}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mskip1mu (\\mathrm{aq})}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mskip1mu (\\mathrm{aq})}\">\n          <mpadded height=\"0\">\n            <mspace width=\"0.056em\" data-latex=\"\\mskip1mu\"></mspace>\n            <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{aq}\">\n              <mi data-mjx-auto-op=\"false\" data-latex=\"aq\">aq</mi>\n            </mrow>\n            <mo data-latex=\")\" stretchy=\"false\">)</mo>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-38', () => toXmlMatch(tex2mml("\\ce{NaOH(aq,$\\infty$)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{NaOH(aq,$\\infty$)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{NaOH}\\mskip2mu (\\mathrm{aq},\\infty )}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NaOH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NaOH\">NaOH</mi>\n    </mrow>\n    <mspace width=\"0.111em\" data-latex=\"\\mskip2mu\"></mspace>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{aq}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"aq\">aq</mi>\n    </mrow>\n    <mo data-latex=\",\">,</mo>\n    <mi mathvariant=\"normal\" data-latex=\"\\infty\">&#x221E;</mi>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n</math>"
  ));
  it('Chem-39', () => toXmlMatch(tex2mml("\\ce{ZnS($c$)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{ZnS($c$)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{ZnS}\\mskip2mu (c )}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{ZnS}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"ZnS\">ZnS</mi>\n    </mrow>\n    <mspace width=\"0.111em\" data-latex=\"\\mskip2mu\"></mspace>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mi data-latex=\"c\">c</mi>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem4', () => {
  it('Chem-40', () => toXmlMatch(tex2mml("\\ce{ZnS(\\ca$c$)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{ZnS(\\ca$c$)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{ZnS}\\mskip2mu ({\\sim}c )}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{ZnS}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"ZnS\">ZnS</mi>\n    </mrow>\n    <mspace width=\"0.111em\" data-latex=\"\\mskip2mu\"></mspace>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\sim}\">\n      <mo data-latex=\"\\sim\">&#x223C;</mo>\n    </mrow>\n    <mi data-latex=\"c\">c</mi>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n</math>"
  ));
  it('Chem-41', () => toXmlMatch(tex2mml("\\ce{NO_x}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{NO_x}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{NO}{\\vphantom{A}}_{\\smash[t]{x }}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NO\">NO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{x }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{x }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{x }\">\n          <mpadded height=\"0\">\n            <mi data-latex=\"x \">x</mi>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-42', () => toXmlMatch(tex2mml("\\ce{Fe^n+}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Fe^n+}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Fe}{\\vphantom{A}}^{n +}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Fe}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Fe\">Fe</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{n+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{n+}\">\n        <mi data-latex=\"n\">n</mi>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-44', () => toXmlMatch(tex2mml("\\ce{\\mu-Cl}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{\\mu-Cl}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{\\mu}\\text{-}\\mathrm{Cl}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{\\mu}\">\n      <mi data-latex=\"\\mu\">&#x3BC;</mi>\n    </mrow>\n    <mtext data-latex=\"\\text{-}\">-</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Cl}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Cl\">Cl</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-45', () => toXmlMatch(tex2mml("\\ce{[Pt(\\eta^2-C2H4)Cl3]-}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{[Pt(\\eta^2-C2H4)Cl3]-}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{[\\mathrm{Pt}(\\mathrm{\\eta}{\\vphantom{A}}^{2}\\text{-}\\mathrm{C}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{4}})\\mathrm{Cl}{\\vphantom{A}}_{\\smash[t]{3}}]{\\vphantom{A}}^{-}}\">\n    <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Pt}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Pt\">Pt</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{\\eta}\">\n      <mi data-latex=\"\\eta\">&#x3B7;</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{2}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2}\">\n        <mn data-latex=\"2\">2</mn>\n      </mrow>\n    </msup>\n    <mtext data-latex=\"\\text{-}\">-</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Cl}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Cl\">Cl</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n    <msup data-latex=\"{\\vphantom{A}}^{-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-46', () => toXmlMatch(tex2mml("\\ce{\\beta +}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{\\beta +}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{\\beta }{\\vphantom{A}}^{+}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{\\beta }\">\n      <mi data-latex=\"\\beta \">&#x3B2;</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{+}\">\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-47', () => toXmlMatch(tex2mml("\\ce{^40_18Ar + \\gamma{} + \\nu_e}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{^40_18Ar + \\gamma{} + \\nu_e}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\vphantom{A}}^{\\hphantom{40}}_{\\hphantom{18}}\\mkern-1.5mu{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{40}}_{\\vphantom{2}\\llap{\\smash[t]{18}}}\\mathrm{Ar} {}+{} \\mathrm{\\gamma{}} {}+{} \\mathrm{\\nu}{\\vphantom{A}}_{\\smash[t]{e }}}\">\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\hphantom{40}}_{\\hphantom{18}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{18}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{18}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"18\">18</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\hphantom{40}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\hphantom{40}\">\n          <mpadded height=\"0\" depth=\"0\">\n            <mphantom>\n              <mn data-latex=\"40\">40</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mspace width=\"-0.083em\" linebreak=\"nobreak\" data-latex=\"\\mkern-1.5mu\"></mspace>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\smash[t]{\\vphantom{2}}\\llap{40}}_{\\vphantom{2}\\llap{\\smash[t]{18}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{2}\\llap{\\smash[t]{18}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mn data-latex=\"2\">2</mn>\n            </mphantom>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{\\smash[t]{18}}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{18}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"18\">18</mn>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\vphantom{2}}\\llap{40}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\vphantom{2}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{2}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mn data-latex=\"2\">2</mn>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\llap{40}\">\n          <mpadded width=\"0\" lspace=\"-1width\">\n            <mn data-latex=\"40\">40</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msubsup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Ar}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Ar\">Ar</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{\\gamma{}}\">\n      <mi data-latex=\"\\gamma\">&#x3B3;</mi>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{\\nu}\">\n      <mi data-latex=\"\\nu\">&#x3BD;</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{e }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{e }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{e }\">\n          <mpadded height=\"0\">\n            <mi data-latex=\"e \">e</mi>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-48', () => toXmlMatch(tex2mml("\\ce{NaOH(aq,$\\infty$)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{NaOH(aq,$\\infty$)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{NaOH}\\mskip2mu (\\mathrm{aq},\\infty )}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NaOH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NaOH\">NaOH</mi>\n    </mrow>\n    <mspace width=\"0.111em\" data-latex=\"\\mskip2mu\"></mspace>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{aq}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"aq\">aq</mi>\n    </mrow>\n    <mo data-latex=\",\">,</mo>\n    <mi mathvariant=\"normal\" data-latex=\"\\infty\">&#x221E;</mi>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n</math>"
  ));
  it('Chem-49', () => toXmlMatch(tex2mml("\\ce{Fe(CN)_{$\\frac{6}{2}$}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Fe(CN)_{$\\frac{6}{2}$}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Fe}(\\mathrm{CN}){\\vphantom{A}}_{\\smash[t]{\\frac{6}{2} }}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Fe}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Fe\">Fe</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CN}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CN\">CN</mi>\n    </mrow>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{\\frac{6}{2} }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\frac{6}{2} }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\frac{6}{2} }\">\n          <mpadded height=\"0\">\n            <mfrac data-latex=\"\\frac{6}{2} \">\n              <mn data-latex=\"6\">6</mn>\n              <mn data-latex=\"2\">2</mn>\n            </mfrac>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem5', () => {
  it('Chem-50', () => toXmlMatch(tex2mml("\\ce{X_{$i$}^{$x$}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{X_{$i$}^{$x$}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{X}{\\vphantom{A}}_{\\smash[t]{i }}{\\vphantom{A}}^{x }}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{X}\">\n      <mi mathvariant=\"normal\" data-latex=\"X\">X</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{i }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{i }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{i }\">\n          <mpadded height=\"0\">\n            <mi data-latex=\"i \">i</mi>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <msup data-latex=\"{\\vphantom{A}}^{x}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{x}\">\n        <mi data-latex=\"x\">x</mi>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-51', () => toXmlMatch(tex2mml("\\ce{X_$i$^$x$}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{X_$i$^$x$}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{X}{\\vphantom{A}}_{\\smash[t]{i }}{\\vphantom{A}}^{x }}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{X}\">\n      <mi mathvariant=\"normal\" data-latex=\"X\">X</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{i }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{i }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{i }\">\n          <mpadded height=\"0\">\n            <mi data-latex=\"i \">i</mi>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <msup data-latex=\"{\\vphantom{A}}^{x}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{x}\">\n        <mi data-latex=\"x\">x</mi>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-52', () => toXmlMatch(tex2mml("\\ce{$cis${-}[PtCl2(NH3)2]}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{$cis${-}[PtCl2(NH3)2]}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{cis {\\text{-}}[\\mathrm{PtCl}{\\vphantom{A}}_{\\smash[t]{2}}(\\mathrm{NH}{\\vphantom{A}}_{\\smash[t]{3}}){\\vphantom{A}}_{\\smash[t]{2}}]}\">\n    <mi data-latex=\"c\">c</mi>\n    <mi data-latex=\"i\">i</mi>\n    <mi data-latex=\"s\">s</mi>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{-}}\">\n      <mtext data-latex=\"\\text{-}\">-</mtext>\n    </mrow>\n    <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{PtCl}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"PtCl\">PtCl</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NH\">NH</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n  </mrow>\n</math>"
  ));
  it('Chem-53', () => toXmlMatch(tex2mml("\\ce{CuS($hP12$)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{CuS($hP12$)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{CuS}(hP12 )}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CuS}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CuS\">CuS</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mi data-latex=\"h\">h</mi>\n    <mi data-latex=\"P\">P</mi>\n    <mn data-latex=\"2\">12</mn>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n  </mrow>\n</math>"
  ));
  it('Chem-54', () => toXmlMatch(tex2mml("\\ce{{Gluconic Acid} + H2O2}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{{Gluconic Acid} + H2O2}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\text{Gluconic Acid}} {}+{} \\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}{\\vphantom{A}}_{\\smash[t]{2}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{Gluconic Acid}}\">\n      <mtext data-latex=\"\\text{Gluconic Acid}\">Gluconic Acid</mtext>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-55', () => toXmlMatch(tex2mml("\\ce{X_{{red}}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{X_{{red}}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{X}{\\vphantom{A}}_{\\smash[t]{\\text{red}}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{X}\">\n      <mi mathvariant=\"normal\" data-latex=\"X\">X</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{\\text{red}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\text{red}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\text{red}}\">\n          <mpadded height=\"0\">\n            <mtext data-latex=\"\\text{red}\">red</mtext>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-56', () => toXmlMatch(tex2mml("\\ce{{(+)}_589{-}[Co(en)3]Cl3}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{{(+)}_589{-}[Co(en)3]Cl3}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\text{(+)}}{\\vphantom{A}}_{\\smash[t]{589}}{\\text{-}}[\\mathrm{Co}(\\mathrm{en}){\\vphantom{A}}_{\\smash[t]{3}}]\\mathrm{Cl}{\\vphantom{A}}_{\\smash[t]{3}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{(+)}}\">\n      <mtext data-latex=\"\\text{(+)}\">(+)</mtext>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{589}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{589}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{589}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"589\">589</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{-}}\">\n      <mtext data-latex=\"\\text{-}\">-</mtext>\n    </mrow>\n    <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Co}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Co\">Co</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{en}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"en\">en</mi>\n    </mrow>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Cl}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Cl\">Cl</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-57', () => toXmlMatch(tex2mml("\\ce{C6H5-CHO}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{C6H5-CHO}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{C}{\\vphantom{A}}_{\\smash[t]{6}}\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{5}}{-}\\mathrm{CHO}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{6}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{6}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{6}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"6\">6</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{5}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{5}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{5}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"5\">5</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n      <mo data-latex=\"-\">&#x2212;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{CHO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"CHO\">CHO</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-58', () => toXmlMatch(tex2mml("\\ce{A-B=C#D}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A-B=C#D}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A}{-}\\mathrm{B}{=}\\mathrm{C}{\\equiv}\\mathrm{D}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n      <mo data-latex=\"-\">&#x2212;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{=}\">\n      <mo data-latex=\"=\">=</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\equiv}\">\n      <mo data-latex=\"\\equiv\">&#x2261;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{D}\">\n      <mi mathvariant=\"normal\" data-latex=\"D\">D</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-59', () => toXmlMatch(tex2mml("\\ce{A\\bond{-}B\\bond{=}C\\bond{#}D}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A\\bond{-}B\\bond{=}C\\bond{#}D}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A}{-}\\mathrm{B}{=}\\mathrm{C}{\\equiv}\\mathrm{D}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n      <mo data-latex=\"-\">&#x2212;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{=}\">\n      <mo data-latex=\"=\">=</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\equiv}\">\n      <mo data-latex=\"\\equiv\">&#x2261;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{D}\">\n      <mi mathvariant=\"normal\" data-latex=\"D\">D</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem6', () => {
  it('Chem-60', () => toXmlMatch(tex2mml("\\ce{A\\bond{1}B\\bond{2}C\\bond{3}D}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A\\bond{1}B\\bond{2}C\\bond{3}D}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A}{-}\\mathrm{B}{=}\\mathrm{C}{\\equiv}\\mathrm{D}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n      <mo data-latex=\"-\">&#x2212;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{=}\">\n      <mo data-latex=\"=\">=</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\equiv}\">\n      <mo data-latex=\"\\equiv\">&#x2261;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{D}\">\n      <mi mathvariant=\"normal\" data-latex=\"D\">D</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-61', () => toXmlMatch(tex2mml("\\ce{A\\bond{~}B\\bond{~-}C}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A\\bond{~}B\\bond{~-}C}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\\raise2mu{\\kern2mu\\tiny\\text{-}\\kern1mu\\text{-}\\kern1mu\\text{-}\\kern2mu}}}\\mathrm{C}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{-}{}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\">\n        <mpadded width=\"0\">\n          <mphantom>\n            <mo data-latex=\"-\">&#x2212;</mo>\n          </mphantom>\n        </mpadded>\n      </mrow>\n      <mpadded height=\"+0.111em\" depth=\"-0.111em\" voffset=\"+0.111em\" data-latex=\"{}\">\n        <mrow data-mjx-texclass=\"ORD\">\n          <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n          <mstyle mathsize=\"0.5em\">\n            <mtext data-latex=\"\\text{-}\">-</mtext>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n            <mtext data-latex=\"\\text{-}\">-</mtext>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n            <mtext data-latex=\"\\text{-}\">-</mtext>\n            <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n          </mstyle>\n        </mrow>\n      </mpadded>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rlap{\\lower.1em{-}}{}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\lower.1em{-}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"-.1em\" depth=\"+.1em\" voffset=\"-.1em\" data-latex=\"\\lower.1em{-}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mpadded height=\"+.1em\" depth=\"-.1em\" voffset=\"+.1em\" data-latex=\"{}\">\n        <mrow data-mjx-texclass=\"ORD\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\">\n            <mpadded width=\"0\">\n              <mphantom>\n                <mo data-latex=\"-\">&#x2212;</mo>\n              </mphantom>\n            </mpadded>\n          </mrow>\n          <mpadded height=\"+0.111em\" depth=\"-0.111em\" voffset=\"+0.111em\" data-latex=\"{}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n              <mstyle mathsize=\"0.5em\">\n                <mtext data-latex=\"\\text{-}\">-</mtext>\n                <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n                <mtext data-latex=\"\\text{-}\">-</mtext>\n                <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n                <mtext data-latex=\"\\text{-}\">-</mtext>\n                <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n              </mstyle>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mpadded>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-62', () => toXmlMatch(tex2mml("\\ce{A\\bond{~--}B\\bond{~=}C\\bond{-~-}D}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A\\bond{~--}B\\bond{~=}C\\bond{-~-}D}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\\raise2mu{\\kern2mu\\tiny\\text{-}\\kern1mu\\text{-}\\kern1mu\\text{-}\\kern2mu}}\\mathrm{D}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rlap{\\lower.2em{-}}\\rlap{\\raise.2em{\\tripledash}}-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\lower.2em{-}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"-.2em\" depth=\"+.2em\" voffset=\"-.2em\" data-latex=\"\\lower.2em{-}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\raise.2em{\\tripledash}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"+.2em\" depth=\"-.2em\" voffset=\"+.2em\" data-latex=\"\\vphantom{-}\\raise2mu{\\kern2mu\\tiny\\text{-}\\kern1mu\\text{-}\\kern1mu\\text{-}\\kern2mu}}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mo data-latex=\"-\">&#x2212;</mo>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n              <mpadded height=\"+0.111em\" depth=\"-0.111em\" voffset=\"+0.111em\" data-latex=\"{}\">\n                <mrow data-mjx-texclass=\"ORD\">\n                  <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n                  <mstyle mathsize=\"0.5em\">\n                    <mtext data-latex=\"\\text{-}\">-</mtext>\n                    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n                    <mtext data-latex=\"\\text{-}\">-</mtext>\n                    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n                    <mtext data-latex=\"\\text{-}\">-</mtext>\n                    <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n                  </mstyle>\n                </mrow>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mo data-latex=\"-\">&#x2212;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rlap{\\lower.2em{-}}\\rlap{\\raise.2em{\\tripledash}}-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\lower.2em{-}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"-.2em\" depth=\"+.2em\" voffset=\"-.2em\" data-latex=\"\\lower.2em{-}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\raise.2em{\\tripledash}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"+.2em\" depth=\"-.2em\" voffset=\"+.2em\" data-latex=\"\\vphantom{-}\\raise2mu{\\kern2mu\\tiny\\text{-}\\kern1mu\\text{-}\\kern1mu\\text{-}\\kern2mu}}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mo data-latex=\"-\">&#x2212;</mo>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n              <mpadded height=\"+0.111em\" depth=\"-0.111em\" voffset=\"+0.111em\" data-latex=\"{}\">\n                <mrow data-mjx-texclass=\"ORD\">\n                  <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n                  <mstyle mathsize=\"0.5em\">\n                    <mtext data-latex=\"\\text{-}\">-</mtext>\n                    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n                    <mtext data-latex=\"\\text{-}\">-</mtext>\n                    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n                    <mtext data-latex=\"\\text{-}\">-</mtext>\n                    <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n                  </mstyle>\n                </mrow>\n              </mpadded>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mo data-latex=\"-\">&#x2212;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rlap{\\lower.2em{-}}\\rlap{\\raise.2em{-}}\\vphantom{-}{}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\lower.2em{-}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"-.2em\" depth=\"+.2em\" voffset=\"-.2em\" data-latex=\"\\lower.2em{-}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\rlap{\\raise.2em{-}}\">\n        <mpadded width=\"0\">\n          <mpadded height=\"+.2em\" depth=\"-.2em\" voffset=\"+.2em\" data-latex=\"\\raise.2em{-}\">\n            <mrow data-mjx-texclass=\"ORD\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </mpadded>\n        </mpadded>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{-}\">\n        <mpadded width=\"0\">\n          <mphantom>\n            <mo data-latex=\"-\">&#x2212;</mo>\n          </mphantom>\n        </mpadded>\n      </mrow>\n      <mpadded height=\"+0.111em\" depth=\"-0.111em\" voffset=\"+0.111em\" data-latex=\"{}\">\n        <mrow data-mjx-texclass=\"ORD\">\n          <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n          <mstyle mathsize=\"0.5em\">\n            <mtext data-latex=\"\\text{-}\">-</mtext>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n            <mtext data-latex=\"\\text{-}\">-</mtext>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\kern1mu\"></mspace>\n            <mtext data-latex=\"\\text{-}\">-</mtext>\n            <mspace width=\"0.111em\" linebreak=\"nobreak\" data-latex=\"\\kern2mu\"></mspace>\n          </mstyle>\n        </mrow>\n      </mpadded>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{D}\">\n      <mi mathvariant=\"normal\" data-latex=\"D\">D</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-63', () => toXmlMatch(tex2mml("\\ce{A\\bond{...}B\\bond{....}C}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A\\bond{...}B\\bond{....}C}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A}{{\\cdot}{\\cdot}{\\cdot}}\\mathrm{B}{{\\cdot}{\\cdot}{\\cdot}{\\cdot}}\\mathrm{C}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\cdot}{\\cdot}{\\cdot}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\cdot}{\\cdot}{\\cdot}{\\cdot}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n        <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n      </mrow>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-64', () => toXmlMatch(tex2mml("\\ce{A\\bond{->}B\\bond{<-}C}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A\\bond{-&gt;}B\\bond{&lt;-}C}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A}{\\rightarrow}\\mathrm{B}{\\leftarrow}\\mathrm{C}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rightarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\rightarrow\">&#x2192;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\leftarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\leftarrow\">&#x2190;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-65', () => toXmlMatch(tex2mml("\\ce{KCr(SO4)2*12H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{KCr(SO4)2*12H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{KCr}(\\mathrm{SO}{\\vphantom{A}}_{\\smash[t]{4}}){\\vphantom{A}}_{\\smash[t]{2}}\\,{\\cdot}\\,12\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{KCr}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"KCr\">KCr</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{SO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"SO\">SO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n      <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    </mrow>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mn data-latex=\"2\">12</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-66', () => toXmlMatch(tex2mml("\\ce{KCr(SO4)2.12H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{KCr(SO4)2.12H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{KCr}(\\mathrm{SO}{\\vphantom{A}}_{\\smash[t]{4}}){\\vphantom{A}}_{\\smash[t]{2}}\\,{\\cdot}\\,12\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{KCr}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"KCr\">KCr</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{SO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"SO\">SO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n      <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    </mrow>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mn data-latex=\"2\">12</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-67', () => toXmlMatch(tex2mml("\\ce{KCr(SO4)2 * 12 H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{KCr(SO4)2 * 12 H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{KCr}(\\mathrm{SO}{\\vphantom{A}}_{\\smash[t]{4}}){\\vphantom{A}}_{\\smash[t]{2}}\\,{\\cdot}\\,12\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{KCr}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"KCr\">KCr</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{SO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"SO\">SO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n      <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    </mrow>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mn data-latex=\"2\">12</mn>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-68', () => toXmlMatch(tex2mml("\\ce{Fe^{II}Fe^{III}2O4}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Fe^{II}Fe^{III}2O4}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Fe}{\\vphantom{A}}^{\\mathrm{II}}\\mathrm{Fe}{\\vphantom{A}}^{\\mathrm{III}}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}{\\vphantom{A}}_{\\smash[t]{4}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Fe}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Fe\">Fe</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{\\mathrm{II}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{II}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{II}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"II\">II</mi>\n        </mrow>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Fe}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Fe\">Fe</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{\\mathrm{III}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{III}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{III}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"III\">III</mi>\n        </mrow>\n      </mrow>\n    </msup>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-69', () => toXmlMatch(tex2mml("\\ce{OCO^{.-}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{OCO^{.-}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{OCO}{\\vphantom{A}}^{\\mkern1mu \\bullet\\mkern1mu -}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{OCO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"OCO\">OCO</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{\\mkern1mu\\bullet\\mkern1mu-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mkern1mu\\bullet\\mkern1mu-}\">\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mo data-latex=\"\\bullet\">&#x2219;</mo>\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem7', () => {
  it('Chem-70', () => toXmlMatch(tex2mml("\\ce{NO^{(2.)-}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{NO^{(2.)-}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{NO}{\\vphantom{A}}^{(2\\mkern1mu \\bullet\\mkern1mu )-}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NO\">NO</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{(2\\mkern1mu\\bullet\\mkern1mu)-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{(2\\mkern1mu\\bullet\\mkern1mu)-}\">\n        <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n        <mn data-latex=\"2\">2</mn>\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mo data-latex=\"\\bullet\">&#x2219;</mo>\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mo data-latex=\")\" stretchy=\"false\">)</mo>\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-71', () => toXmlMatch(tex2mml("\\ce{O''_{i,x}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{O''_{i,x}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{O}{\\vphantom{A}}^{\\prime \\prime }_{\\smash[t]{\\mathrm{i}{,}\\mkern1mu x }}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\prime\\prime}_{\\smash[t]{\\mathrm{i}{,}\\mkern1mu x }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mathrm{i}{,}\\mkern1mu x }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mathrm{i}{,}\\mkern1mu x }\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{i}\">\n              <mi mathvariant=\"normal\" data-latex=\"i\">i</mi>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n              <mo data-latex=\",\">,</mo>\n            </mrow>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n            <mi data-latex=\"x\">x</mi>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\prime\\prime}\">\n        <mi data-mjx-alternate=\"1\" data-latex=\"\\prime\">&#x2032;</mi>\n        <mi data-mjx-alternate=\"1\" data-latex=\"\\prime\">&#x2032;</mi>\n      </mrow>\n    </msubsup>\n  </mrow>\n</math>"
  ));
  it('Chem-72', () => toXmlMatch(tex2mml("\\ce{M^{..}_i}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{M^{..}_i}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{M}{\\vphantom{A}}^{\\mkern1mu \\bullet\\mkern1mu \\mkern1mu \\bullet\\mkern1mu }_{\\smash[t]{\\mathrm{i}}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{M}\">\n      <mi mathvariant=\"normal\" data-latex=\"M\">M</mi>\n    </mrow>\n    <msubsup data-latex=\"{\\vphantom{A}}^{\\mkern1mu\\bullet\\mkern1mu\\mkern1mu\\bullet\\mkern1mu}_{\\smash[t]{\\mathrm{i}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mathrm{i}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mathrm{i}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{i}\">\n              <mi mathvariant=\"normal\" data-latex=\"i\">i</mi>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mkern1mu\\bullet\\mkern1mu\\mkern1mu\\bullet\\mkern1mu}\">\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mo data-latex=\"\\bullet\">&#x2219;</mo>\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n        <mo data-latex=\"\\bullet\">&#x2219;</mo>\n        <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n      </mrow>\n    </msubsup>\n  </mrow>\n</math>"
  ));
  it('Chem-73', () => toXmlMatch(tex2mml("\\ce{$V$^{4'}_{Ti}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{$V$^{4'}_{Ti}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{V {\\vphantom{A}}^{4\\prime }_{\\smash[t]{\\mathrm{Ti}}}}\">\n    <mi data-latex=\"V\">V</mi>\n    <msubsup data-latex=\"{\\vphantom{A}}^{4\\prime}_{\\smash[t]{\\mathrm{Ti}}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mathrm{Ti}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mathrm{Ti}}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Ti}\">\n              <mi data-mjx-auto-op=\"false\" data-latex=\"Ti\">Ti</mi>\n            </mrow>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{4\\prime}\">\n        <mn data-latex=\"4\">4</mn>\n        <mi data-mjx-alternate=\"1\" data-latex=\"\\prime\">&#x2032;</mi>\n      </mrow>\n    </msubsup>\n  </mrow>\n</math>"
  ));
  it('Chem-74', () => toXmlMatch(tex2mml("\\ce{V_{V,1}C_{C,0.8}$V$_{C,0.2}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{V_{V,1}C_{C,0.8}$V$_{C,0.2}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{V}{\\vphantom{A}}_{\\smash[t]{\\mathrm{V}{,}\\mkern1mu 1}}\\mathrm{C}{\\vphantom{A}}_{\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.8}}V {\\vphantom{A}}_{\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.2}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{V}\">\n      <mi mathvariant=\"normal\" data-latex=\"V\">V</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{\\mathrm{V}{,}\\mkern1mu 1}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mathrm{V}{,}\\mkern1mu 1}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mathrm{V}{,}\\mkern1mu 1}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{V}\">\n              <mi mathvariant=\"normal\" data-latex=\"V\">V</mi>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n              <mo data-latex=\",\">,</mo>\n            </mrow>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n            <mn data-latex=\"1\">1</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.8}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.8}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.8}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n              <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n              <mo data-latex=\",\">,</mo>\n            </mrow>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n            <mn data-latex=\".8\">0.8</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mi data-latex=\"V\">V</mi>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{\\mathrm{C}{,}\\mkern1mu 0.2}\">\n          <mpadded height=\"0\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n              <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n              <mo data-latex=\",\">,</mo>\n            </mrow>\n            <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n            <mn data-latex=\".2\">0.2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n  </mrow>\n</math>"
  ));
  it('Chem-75', () => toXmlMatch(tex2mml("\\ce{A + B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A + B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}+{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-76', () => toXmlMatch(tex2mml("\\ce{A - B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A - B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}-{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"-\">&#x2212;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-77', () => toXmlMatch(tex2mml("\\ce{A = B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A = B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}={} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"=\">=</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-78', () => toXmlMatch(tex2mml("\\ce{A \\pm B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A \\pm B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\pm{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"\\pm\">&#xB1;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-79', () => toXmlMatch(tex2mml("\\ce{SO4^2- + Ba^2+ -> BaSO4 v}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{SO4^2- + Ba^2+ -&gt; BaSO4 v}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{SO}{\\vphantom{A}}_{\\smash[t]{4}}{\\vphantom{A}}^{2-} {}+{} \\mathrm{Ba}{\\vphantom{A}}^{2+} {}\\mathrel{\\longrightarrow}{} \\mathrm{BaSO}{\\vphantom{A}}_{\\smash[t]{4}} \\downarrow{} }\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{SO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"SO\">SO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <msup data-latex=\"{\\vphantom{A}}^{2-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2-}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Ba}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Ba\">Ba</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longrightarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\longrightarrow\">&#x27F6;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{BaSO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"BaSO\">BaSO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo stretchy=\"false\" data-latex=\"\\downarrow\">&#x2193;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem8', () => {
  it('Chem-80', () => toXmlMatch(tex2mml("\\ce{A v B (v) -> B ^ B (^)}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A v B (v) -&gt; B ^ B (^)}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} \\downarrow{} ~\\mathrm{B} \\downarrow{}  {}\\mathrel{\\longrightarrow}{} \\mathrm{B} \\uparrow{} ~\\mathrm{B} \\uparrow{} }\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mo stretchy=\"false\" data-latex=\"\\downarrow\">&#x2193;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mo stretchy=\"false\" data-latex=\"\\downarrow\">&#x2193;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\longrightarrow}\">\n      <mo stretchy=\"false\" data-latex=\"\\longrightarrow\">&#x27F6;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mo stretchy=\"false\" data-latex=\"\\uparrow\">&#x2191;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mo stretchy=\"false\" data-latex=\"\\uparrow\">&#x2191;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-81', () => toXmlMatch(tex2mml("\\ce{NO^*}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{NO^*}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{NO}{\\vphantom{A}}^{*}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NO\">NO</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{*}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{*}\">\n        <mo data-latex=\"*\">&#x2217;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-82', () => toXmlMatch(tex2mml("\\ce{1s^2-N}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{1s^2-N}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{1\\mathrm{s}{\\vphantom{A}}^{2}\\text{-}\\mathrm{N}}\">\n    <mn data-latex=\"1\">1</mn>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{s}\">\n      <mi mathvariant=\"normal\" data-latex=\"s\">s</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{2}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2}\">\n        <mn data-latex=\"2\">2</mn>\n      </mrow>\n    </msup>\n    <mtext data-latex=\"\\text{-}\">-</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{N}\">\n      <mi mathvariant=\"normal\" data-latex=\"N\">N</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-83', () => toXmlMatch(tex2mml("\\ce{n-Pr}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{n-Pr}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{n \\text{-}\\mathrm{Pr}}\">\n    <mi data-latex=\"n\">n</mi>\n    <mtext data-latex=\"\\text{-}\">-</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Pr}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Pr\">Pr</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-84', () => toXmlMatch(tex2mml("\\ce{iPr}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{iPr}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{iPr}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{iPr}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"iPr\">iPr</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-85', () => toXmlMatch(tex2mml("\\ce{\\ca Fe}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{\\ca Fe}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\sim}\\mathrm{Fe}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\sim}\">\n      <mo data-latex=\"\\sim\">&#x223C;</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Fe}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Fe\">Fe</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-86', () => toXmlMatch(tex2mml("\\ce{A, B, C; F}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A, B, C; F}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A}{,}\\mkern6mu \\mathrm{B}{,}\\mkern6mu \\mathrm{C}{;}\\mkern6mu \\mathrm{F}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n      <mo data-latex=\",\">,</mo>\n    </mrow>\n    <mspace width=\"0.333em\" linebreak=\"nobreak\" data-latex=\"\\mkern6mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n      <mo data-latex=\",\">,</mo>\n    </mrow>\n    <mspace width=\"0.333em\" linebreak=\"nobreak\" data-latex=\"\\mkern6mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{C}\">\n      <mi mathvariant=\"normal\" data-latex=\"C\">C</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{;}\">\n      <mo data-latex=\";\">;</mo>\n    </mrow>\n    <mspace width=\"0.333em\" linebreak=\"nobreak\" data-latex=\"\\mkern6mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{F}\">\n      <mi mathvariant=\"normal\" data-latex=\"F\">F</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-87', () => toXmlMatch(tex2mml("\\ce{{and others}}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{{and others}}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\text{and others}}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{and others}}\">\n      <mtext data-latex=\"\\text{and others}\">and others</mtext>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-88', () => toXmlMatch(tex2mml("\\ce{Zn^2+  <=>[+ 2OH-][+ 2H+]  $\\underset{\\text{amphoteres Hydroxid}}{\\ce{Zn(OH)2 v}}$  <=>[+ 2OH-][+ 2H+]  $\\underset{\\text{Hydroxozikat}}{\\ce{[Zn(OH)4]^2-}}$}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Zn^2+  &lt;=&gt;[+ 2OH-][+ 2H+]  $\\underset{\\text{amphoteres Hydroxid}}{\\ce{Zn(OH)2 v}}$  &lt;=&gt;[+ 2OH-][+ 2H+]  $\\underset{\\text{Hydroxozikat}}{\\ce{[Zn(OH)4]^2-}}$}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Zn}{\\vphantom{A}}^{2+} {}\\mathrel{\\underset{\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}}{\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}}}{} \\underset{\\text{amphoteres Hydroxid}}{\\ce{Zn(OH)2 v}}  {}\\mathrel{\\underset{\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}}{\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}}}{} \\underset{\\text{Hydroxozikat}}{\\ce{[Zn(OH)4]^2-}} }\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Zn}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Zn\">Zn</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\underset{\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}}{\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}}}\">\n      <munder data-latex=\"\\underset{\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}}{\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}}\">\n        <mover data-latex=\"\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}\">\n          <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}}\">\n            <mover data-latex=\"\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}\">\n              <mrow data-mjx-texclass=\"OP\" data-latex=\"\\limits\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash{{\\leftharpoondown}\\!\\!{-}}\">\n                  <mpadded height=\"0\" depth=\"0\">\n                    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\leftharpoondown}\">\n                      <mo stretchy=\"false\" data-latex=\"\\leftharpoondown\">&#x21BD;</mo>\n                    </mrow>\n                    <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                      <mspace width=\"-0.167em\"></mspace>\n                    </mstyle>\n                    <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                      <mspace width=\"-0.167em\"></mspace>\n                    </mstyle>\n                    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                      <mo data-latex=\"-\">&#x2212;</mo>\n                    </mrow>\n                  </mpadded>\n                </mrow>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\">\n                <mstyle displaystyle=\"false\" scriptlevel=\"0\">\n                  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                    <mo data-latex=\"-\">&#x2212;</mo>\n                  </mrow>\n                  <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                    <mspace width=\"-0.167em\"></mspace>\n                  </mstyle>\n                  <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                    <mspace width=\"-0.167em\"></mspace>\n                  </mstyle>\n                  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rightharpoonup}\">\n                    <mo stretchy=\"false\" data-latex=\"\\rightharpoonup\">&#x21C0;</mo>\n                  </mrow>\n                </mstyle>\n              </mrow>\n            </mover>\n          </mrow>\n          <mrow data-latex=\" {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mo data-latex=\"+\">+</mo>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mn data-latex=\"2\">2</mn>\n            <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n              <mspace width=\"0.167em\"></mspace>\n            </mstyle>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{OH}\">\n              <mi data-mjx-auto-op=\"false\" data-latex=\"OH\">OH</mi>\n            </mrow>\n            <msup data-latex=\"{\\vphantom{A}}^{-}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                  <mpadded width=\"0\">\n                    <mphantom>\n                      <mi data-latex=\"A\">A</mi>\n                    </mphantom>\n                  </mpadded>\n                </mrow>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                <mo data-latex=\"-\">&#x2212;</mo>\n              </mrow>\n            </msup>\n          </mrow>\n        </mover>\n        <mpadded height=\"-0.333em\" depth=\"+0.333em\" voffset=\"-0.333em\" data-latex=\"\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}\">\n          <mrow data-mjx-texclass=\"ORD\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mo data-latex=\"+\">+</mo>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mn data-latex=\"2\">2</mn>\n            <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n              <mspace width=\"0.167em\"></mspace>\n            </mstyle>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n              <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n            </mrow>\n            <msup data-latex=\"{\\vphantom{A}}^{+}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                  <mpadded width=\"0\">\n                    <mphantom>\n                      <mi data-latex=\"A\">A</mi>\n                    </mphantom>\n                  </mpadded>\n                </mrow>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{+}\">\n                <mo data-latex=\"+\">+</mo>\n              </mrow>\n            </msup>\n          </mrow>\n        </mpadded>\n      </munder>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <munder data-latex=\"\\underset{\\text{amphoteres Hydroxid}}{\\ce{Zn(OH)2 v}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Zn}(\\mathrm{OH}){\\vphantom{A}}_{\\smash[t]{2}} \\downarrow{} }\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Zn}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"Zn\">Zn</mi>\n        </mrow>\n        <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{OH}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"OH\">OH</mi>\n        </mrow>\n        <mo data-latex=\")\" stretchy=\"false\">)</mo>\n        <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"2\">2</mn>\n              </mpadded>\n            </mrow>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\" data-latex=\"\\downarrow\">&#x2193;</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n      </mrow>\n      <mtext data-latex=\"\\text{amphoteres Hydroxid}\">amphoteres Hydroxid</mtext>\n    </munder>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\underset{\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}}{\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}}}\">\n      <munder data-latex=\"\\underset{\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}}{\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}}\">\n        <mover data-latex=\"\\overset{ {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}}{\\longrightleftharpoons}\">\n          <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}}\">\n            <mover data-latex=\"\\mathop{\\smash{{\\leftharpoondown}\\!\\!{-}}}\\limits^{\\textstyle{-}\\!\\!{\\rightharpoonup}}\">\n              <mrow data-mjx-texclass=\"OP\" data-latex=\"\\limits\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash{{\\leftharpoondown}\\!\\!{-}}\">\n                  <mpadded height=\"0\" depth=\"0\">\n                    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\leftharpoondown}\">\n                      <mo stretchy=\"false\" data-latex=\"\\leftharpoondown\">&#x21BD;</mo>\n                    </mrow>\n                    <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                      <mspace width=\"-0.167em\"></mspace>\n                    </mstyle>\n                    <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                      <mspace width=\"-0.167em\"></mspace>\n                    </mstyle>\n                    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                      <mo data-latex=\"-\">&#x2212;</mo>\n                    </mrow>\n                  </mpadded>\n                </mrow>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\">\n                <mstyle displaystyle=\"false\" scriptlevel=\"0\">\n                  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                    <mo data-latex=\"-\">&#x2212;</mo>\n                  </mrow>\n                  <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                    <mspace width=\"-0.167em\"></mspace>\n                  </mstyle>\n                  <mstyle scriptlevel=\"0\" data-latex=\"\\!\">\n                    <mspace width=\"-0.167em\"></mspace>\n                  </mstyle>\n                  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\rightharpoonup}\">\n                    <mo stretchy=\"false\" data-latex=\"\\rightharpoonup\">&#x21C0;</mo>\n                  </mrow>\n                </mstyle>\n              </mrow>\n            </mover>\n          </mrow>\n          <mrow data-latex=\" {}+{} 2\\,\\mathrm{OH}{\\vphantom{A}}^{-}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mo data-latex=\"+\">+</mo>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mn data-latex=\"2\">2</mn>\n            <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n              <mspace width=\"0.167em\"></mspace>\n            </mstyle>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{OH}\">\n              <mi data-mjx-auto-op=\"false\" data-latex=\"OH\">OH</mi>\n            </mrow>\n            <msup data-latex=\"{\\vphantom{A}}^{-}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                  <mpadded width=\"0\">\n                    <mphantom>\n                      <mi data-latex=\"A\">A</mi>\n                    </mphantom>\n                  </mpadded>\n                </mrow>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n                <mo data-latex=\"-\">&#x2212;</mo>\n              </mrow>\n            </msup>\n          </mrow>\n        </mover>\n        <mpadded height=\"-0.333em\" depth=\"+0.333em\" voffset=\"-0.333em\" data-latex=\"\\lower6mu{ {}+{} 2\\,\\mathrm{H}{\\vphantom{A}}^{+}}\">\n          <mrow data-mjx-texclass=\"ORD\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mo data-latex=\"+\">+</mo>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n            <mn data-latex=\"2\">2</mn>\n            <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n              <mspace width=\"0.167em\"></mspace>\n            </mstyle>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n              <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n            </mrow>\n            <msup data-latex=\"{\\vphantom{A}}^{+}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n                <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                  <mpadded width=\"0\">\n                    <mphantom>\n                      <mi data-latex=\"A\">A</mi>\n                    </mphantom>\n                  </mpadded>\n                </mrow>\n              </mrow>\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"{+}\">\n                <mo data-latex=\"+\">+</mo>\n              </mrow>\n            </msup>\n          </mrow>\n        </mpadded>\n      </munder>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <munder data-latex=\"\\underset{\\text{Hydroxozikat}}{\\ce{[Zn(OH)4]^2-}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{[\\mathrm{Zn}(\\mathrm{OH}){\\vphantom{A}}_{\\smash[t]{4}}]{\\vphantom{A}}^{2-}}\">\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Zn}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"Zn\">Zn</mi>\n        </mrow>\n        <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{OH}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"OH\">OH</mi>\n        </mrow>\n        <mo data-latex=\")\" stretchy=\"false\">)</mo>\n        <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"4\">4</mn>\n              </mpadded>\n            </mrow>\n          </mrow>\n        </msub>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n        <msup data-latex=\"{\\vphantom{A}}^{2-}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2-}\">\n            <mn data-latex=\"2\">2</mn>\n            <mo data-latex=\"-\">&#x2212;</mo>\n          </mrow>\n        </msup>\n      </mrow>\n      <mtext data-latex=\"\\text{Hydroxozikat}\">Hydroxozikat</mtext>\n    </munder>\n  </mrow>\n</math>"
  ));
  it('Chem-89', () => toXmlMatch(tex2mml("\\ce{$K = \\frac{[\\ce{Hg^2+}][\\ce{Hg}]}{[\\ce{Hg2^2+}]}$}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{$K = \\frac{[\\ce{Hg^2+}][\\ce{Hg}]}{[\\ce{Hg2^2+}]}$}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{K = \\frac{[\\ce{Hg^2+}][\\ce{Hg}]}{[\\ce{Hg2^2+}]} }\">\n    <mi data-latex=\"K\">K</mi>\n    <mo data-latex=\"=\">=</mo>\n    <mfrac data-latex=\"\\frac{[\\ce{Hg^2+}][\\ce{Hg}]}{[\\ce{Hg2^2+}]}\">\n      <mrow data-latex=\"{\\mathrm{Hg}}]\">\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Hg}{\\vphantom{A}}^{2+}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n            <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n          </mrow>\n          <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n              <mn data-latex=\"2\">2</mn>\n              <mo data-latex=\"+\">+</mo>\n            </mrow>\n          </msup>\n        </mrow>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Hg}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n            <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n          </mrow>\n        </mrow>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n      </mrow>\n      <mrow data-latex=\"{\\mathrm{Hg}{\\vphantom{A}}_{\\smash[t]{2}}{\\vphantom{A}}^{2+}}]\">\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Hg}{\\vphantom{A}}_{\\smash[t]{2}}{\\vphantom{A}}^{2+}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n            <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n          </mrow>\n          <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n                <mpadded height=\"0\">\n                  <mn data-latex=\"2\">2</mn>\n                </mpadded>\n              </mrow>\n            </mrow>\n          </msub>\n          <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n              <mn data-latex=\"2\">2</mn>\n              <mo data-latex=\"+\">+</mo>\n            </mrow>\n          </msup>\n        </mrow>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n      </mrow>\n    </mfrac>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem9', () => {
  it('Chem-90', () => toXmlMatch(tex2mml("\\ce{$K = \\ce{\\frac{[Hg^2+][Hg]}{[Hg2^2+]}}$}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{$K = \\ce{\\frac{[Hg^2+][Hg]}{[Hg2^2+]}}$}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{K =  \\frac{[\\mathrm{Hg}{\\vphantom{A}}^{2+}][\\mathrm{Hg}]}{[\\mathrm{Hg}{\\vphantom{A}}_{\\smash[t]{2}}{\\vphantom{A}}^{2+}]}}\">\n    <mi data-latex=\"K\">K</mi>\n    <mo data-latex=\"=\">=</mo>\n    <mfrac data-latex=\"\\frac{[\\mathrm{Hg}{\\vphantom{A}}^{2+}][\\mathrm{Hg}]}{[\\mathrm{Hg}{\\vphantom{A}}_{\\smash[t]{2}}{\\vphantom{A}}^{2+}]}\">\n      <mrow data-latex=\"[\\mathrm{Hg}{\\vphantom{A}}^{2+}][\\mathrm{Hg}]\">\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n        </mrow>\n        <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n            <mn data-latex=\"2\">2</mn>\n            <mo data-latex=\"+\">+</mo>\n          </mrow>\n        </msup>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n        </mrow>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n      </mrow>\n      <mrow data-latex=\"[\\mathrm{Hg}{\\vphantom{A}}_{\\smash[t]{2}}{\\vphantom{A}}^{2+}]\">\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n        </mrow>\n        <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"2\">2</mn>\n              </mpadded>\n            </mrow>\n          </mrow>\n        </msub>\n        <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n            <mn data-latex=\"2\">2</mn>\n            <mo data-latex=\"+\">+</mo>\n          </mrow>\n        </msup>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n      </mrow>\n    </mfrac>\n  </mrow>\n</math>"
  ));
  it('Chem-92', () => toXmlMatch(tex2mml("\\pu{123 kJ}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 kJ}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{kJ}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-93', () => toXmlMatch(tex2mml("\\pu{123 mm2}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 mm2}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{mm^{2}}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{mm^{2}}\">\n      <msup data-latex=\"mm^{2}\">\n        <mi data-mjx-auto-op=\"false\" data-latex=\"m\">mm</mi>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2}\">\n          <mn data-latex=\"2\">2</mn>\n        </mrow>\n      </msup>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-94', () => toXmlMatch(tex2mml("\\pu{123 J s}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 J s}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{J}\\mkern3mu \\mathrm{s}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{J}\">\n      <mi mathvariant=\"normal\" data-latex=\"J\">J</mi>\n    </mrow>\n    <mspace width=\"0.167em\" linebreak=\"nobreak\" data-latex=\"\\mkern3mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{s}\">\n      <mi mathvariant=\"normal\" data-latex=\"s\">s</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-95', () => toXmlMatch(tex2mml("\\pu{123 J*s}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 J*s}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{J}\\mkern1mu{\\cdot}\\mkern1mu \\mathrm{s}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{J}\">\n      <mi mathvariant=\"normal\" data-latex=\"J\">J</mi>\n    </mrow>\n    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n      <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    </mrow>\n    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{s}\">\n      <mi mathvariant=\"normal\" data-latex=\"s\">s</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-96', () => toXmlMatch(tex2mml("\\pu{123 kJ/mol}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 kJ/mol}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{kJ}/\\mathrm{mol}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\">\n      <mo data-latex=\"/\">/</mo>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{mol}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"mol\">mol</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-97', () => toXmlMatch(tex2mml("\\pu{123 kJ//mol}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 kJ//mol}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathchoice{\\textstyle\\frac{\\mathrm{kJ}}{\\mathrm{mol}}}{\\frac{\\mathrm{kJ}}{\\mathrm{mol}}}{\\frac{\\mathrm{kJ}}{\\mathrm{mol}}}{\\frac{\\mathrm{kJ}}{\\mathrm{mol}}}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mstyle displaystyle=\"false\" scriptlevel=\"0\" data-latex=\"\\textstyle\\frac{\\mathrm{kJ}}{\\mathrm{mol}}\">\n      <mfrac data-latex=\"\\frac{\\mathrm{kJ}}{\\mathrm{mol}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n        </mrow>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{mol}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"mol\">mol</mi>\n        </mrow>\n      </mfrac>\n    </mstyle>\n  </mrow>\n</math>"
  ));
  it('Chem-98', () => toXmlMatch(tex2mml("\\pu{123 kJ mol-1}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 kJ mol-1}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{kJ}\\mkern3mu \\mathrm{mol^{-1}}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n    <mspace width=\"0.167em\" linebreak=\"nobreak\" data-latex=\"\\mkern3mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{mol^{-1}}\">\n      <msup data-latex=\"mol^{-1}\">\n        <mi data-mjx-auto-op=\"false\" data-latex=\"ol\">mol</mi>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-1}\">\n          <mo data-latex=\"-\">&#x2212;</mo>\n          <mn data-latex=\"1\">1</mn>\n        </mrow>\n      </msup>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-99', () => toXmlMatch(tex2mml("\\pu{123 kJ*mol-1}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{123 kJ*mol-1}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{123~\\mathrm{kJ}\\mkern1mu{\\cdot}\\mkern1mu \\mathrm{mol^{-1}}}\">\n    <mn data-latex=\"23\">123</mn>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\cdot}\">\n      <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    </mrow>\n    <mspace width=\"0.056em\" linebreak=\"nobreak\" data-latex=\"\\mkern1mu\"></mspace>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{mol^{-1}}\">\n      <msup data-latex=\"mol^{-1}\">\n        <mi data-mjx-auto-op=\"false\" data-latex=\"ol\">mol</mi>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-1}\">\n          <mo data-latex=\"-\">&#x2212;</mo>\n          <mn data-latex=\"1\">1</mn>\n        </mrow>\n      </msup>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-100', () => toXmlMatch(tex2mml("\\pu{1.2e3 kJ}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{1.2e3 kJ}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{1.2\\cdot 10^{3}~\\mathrm{kJ}}\">\n    <mn data-latex=\".2\">1.2</mn>\n    <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    <msup data-latex=\"0^{3}\">\n      <mn data-latex=\"0\">10</mn>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{3}\">\n        <mn data-latex=\"3\">3</mn>\n      </mrow>\n    </msup>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-101', () => toXmlMatch(tex2mml("\\pu{1,2e3 kJ}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{1,2e3 kJ}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{1{,}2\\cdot 10^{3}~\\mathrm{kJ}}\">\n    <mn data-latex=\"1\">1</mn>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n      <mo data-latex=\",\">,</mo>\n    </mrow>\n    <mn data-latex=\"2\">2</mn>\n    <mo data-latex=\"\\cdot\">&#x22C5;</mo>\n    <msup data-latex=\"0^{3}\">\n      <mn data-latex=\"0\">10</mn>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{3}\">\n        <mn data-latex=\"3\">3</mn>\n      </mrow>\n    </msup>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-102', () => toXmlMatch(tex2mml("\\pu{1.2E3 kJ}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{1.2E3 kJ}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{1.2\\times 10^{3}~\\mathrm{kJ}}\">\n    <mn data-latex=\".2\">1.2</mn>\n    <mo data-latex=\"\\times\">&#xD7;</mo>\n    <msup data-latex=\"0^{3}\">\n      <mn data-latex=\"0\">10</mn>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{3}\">\n        <mn data-latex=\"3\">3</mn>\n      </mrow>\n    </msup>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-103', () => toXmlMatch(tex2mml("\\pu{1,2E3 kJ}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\pu{1,2E3 kJ}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{1{,}2\\times 10^{3}~\\mathrm{kJ}}\">\n    <mn data-latex=\"1\">1</mn>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{,}\">\n      <mo data-latex=\",\">,</mo>\n    </mrow>\n    <mn data-latex=\"2\">2</mn>\n    <mo data-latex=\"\\times\">&#xD7;</mo>\n    <msup data-latex=\"0^{3}\">\n      <mn data-latex=\"0\">10</mn>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{3}\">\n        <mn data-latex=\"3\">3</mn>\n      </mrow>\n    </msup>\n    <mtext data-latex=\"~\">&#xA0;</mtext>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{kJ}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"kJ\">kJ</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
})

describe('Mhchem-Ams', () => {
  beforeEach(() => setupTex(["base", "ams", "mhchem"]));
  it('Chem-2', () => toXmlMatch(tex2mml("\\ce{Hg^2+ ->[I-] HgI2 ->[I-] [Hg^{II}I4]^2-}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Hg^2+ -&gt;[I-] HgI2 -&gt;[I-] [Hg^{II}I4]^2-}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Hg}{\\vphantom{A}}^{2+} {}\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}{} \\mathrm{HgI}{\\vphantom{A}}_{\\smash[t]{2}} {}\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}{} [\\mathrm{Hg}{\\vphantom{A}}^{\\mathrm{II}}\\mathrm{I}{\\vphantom{A}}_{\\smash[t]{4}}]{\\vphantom{A}}^{2-}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}\">\n      <mover data-latex=\"\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{I}\">\n            <mi mathvariant=\"normal\" data-latex=\"I\">I</mi>\n          </mrow>\n          <msup data-latex=\"{\\vphantom{A}}^{-}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </msup>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </mover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{HgI}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"HgI\">HgI</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}\">\n      <mover data-latex=\"\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{I}\">\n            <mi mathvariant=\"normal\" data-latex=\"I\">I</mi>\n          </mrow>\n          <msup data-latex=\"{\\vphantom{A}}^{-}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </msup>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </mover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{\\mathrm{II}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{II}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{II}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"II\">II</mi>\n        </mrow>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{I}\">\n      <mi mathvariant=\"normal\" data-latex=\"I\">I</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n    <msup data-latex=\"{\\vphantom{A}}^{2-}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2-}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"-\">&#x2212;</mo>\n      </mrow>\n    </msup>\n  </mrow>\n</math>"
  ));
  it('Chem-30', () => toXmlMatch(tex2mml("\\ce{A ->[H2O] B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A -&gt;[H2O] B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\xrightarrow{\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow{\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}}\">\n      <mover data-latex=\"\\xrightarrow{\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n            <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n          </mrow>\n          <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n                <mpadded height=\"0\">\n                  <mn data-latex=\"2\">2</mn>\n                </mpadded>\n              </mrow>\n            </mrow>\n          </msub>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n            <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n          </mrow>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </mover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-31', () => toXmlMatch(tex2mml("\\ce{A ->[{text above}][{text below}] B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A -&gt;[{text above}][{text below}] B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\xrightarrow[{{\\text{text below}}}]{{\\text{text above}}}}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow[{{\\text{text below}}}]{{\\text{text above}}}}\">\n      <munderover data-latex=\"\\xrightarrow[{{\\text{text below}}}]{{\\text{text above}}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\".15em\" depth=\"-.15em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{{\\text{text below}}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{text below}}\">\n              <mtext data-latex=\"\\text{text below}\">text below</mtext>\n            </mrow>\n          </mrow>\n          <mspace height=\".75em\"></mspace>\n        </mpadded>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\text{text above}}\">\n            <mtext data-latex=\"\\text{text above}\">text above</mtext>\n          </mrow>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </munderover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-32', () => toXmlMatch(tex2mml("\\ce{A ->[$x$][$x_i$] B}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{A -&gt;[$x$][$x_i$] B}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{A} {}\\mathrel{\\xrightarrow[{x_i }]{x }}{} \\mathrm{B}}\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{A}\">\n      <mi mathvariant=\"normal\" data-latex=\"A\">A</mi>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow[{x_i }]{x }}\">\n      <munderover data-latex=\"\\xrightarrow[{x_i }]{x }\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\".15em\" depth=\"-.15em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{x_i }\">\n            <msub data-latex=\"x_i\">\n              <mi data-latex=\"x\">x</mi>\n              <mi data-latex=\"i\">i</mi>\n            </msub>\n          </mrow>\n          <mspace height=\".75em\"></mspace>\n        </mpadded>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mi data-latex=\"x \">x</mi>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </munderover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{B}\">\n      <mi mathvariant=\"normal\" data-latex=\"B\">B</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-43', () => toXmlMatch(tex2mml("\\ce{x Na(NH4)HPO4 ->[\\Delta] (NaPO3)_x + x NH3 ^ + x H2O}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{x Na(NH4)HPO4 -&gt;[\\Delta] (NaPO3)_x + x NH3 ^ + x H2O}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{x\\,\\mathrm{Na}(\\mathrm{NH}{\\vphantom{A}}_{\\smash[t]{4}})\\mathrm{HPO}{\\vphantom{A}}_{\\smash[t]{4}} {}\\mathrel{\\xrightarrow{\\mathrm{\\Delta}}}{} (\\mathrm{NaPO}{\\vphantom{A}}_{\\smash[t]{3}}){\\vphantom{A}}_{\\smash[t]{x }} {}+{} x\\,\\mathrm{NH}{\\vphantom{A}}_{\\smash[t]{3}} \\uparrow{}  {}+{} x\\,\\mathrm{H}{\\vphantom{A}}_{\\smash[t]{2}}\\mathrm{O}}\">\n    <mi data-latex=\"x\">x</mi>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Na}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Na\">Na</mi>\n    </mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NH\">NH</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{HPO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"HPO\">HPO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"4\">4</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow{\\mathrm{\\Delta}}}\">\n      <mover data-latex=\"\\xrightarrow{\\mathrm{\\Delta}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{\\Delta}\">\n            <mi mathvariant=\"normal\" data-latex=\"\\Delta\">&#x394;</mi>\n          </mrow>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </mover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"(\" stretchy=\"false\">(</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NaPO}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NaPO\">NaPO</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo data-latex=\")\" stretchy=\"false\">)</mo>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{x }}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{x }}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{x }\">\n          <mpadded height=\"0\">\n            <mi data-latex=\"x \">x</mi>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mi data-latex=\"x\">x</mi>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{NH}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"NH\">NH</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{3}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{3}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{3}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"3\">3</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mo stretchy=\"false\" data-latex=\"\\uparrow\">&#x2191;</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mo data-latex=\"+\">+</mo>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mi data-latex=\"x\">x</mi>\n    <mstyle scriptlevel=\"0\" data-latex=\"\\,\">\n      <mspace width=\"0.167em\"></mspace>\n    </mstyle>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{H}\">\n      <mi mathvariant=\"normal\" data-latex=\"H\">H</mi>\n    </mrow>\n    <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n          <mpadded height=\"0\">\n            <mn data-latex=\"2\">2</mn>\n          </mpadded>\n        </mrow>\n      </mrow>\n    </msub>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{O}\">\n      <mi mathvariant=\"normal\" data-latex=\"O\">O</mi>\n    </mrow>\n  </mrow>\n</math>"
  ));
  it('Chem-91', () => toXmlMatch(tex2mml("\\ce{Hg^2+ ->[I-]  $\\underset{\\mathrm{red}}{\\ce{HgI2}}$  ->[I-]  $\\underset{\\mathrm{red}}{\\ce{[Hg^{II}I4]^2-}}$}"),
    "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" data-latex=\"\\ce{Hg^2+ -&gt;[I-]  $\\underset{\\mathrm{red}}{\\ce{HgI2}}$  -&gt;[I-]  $\\underset{\\mathrm{red}}{\\ce{[Hg^{II}I4]^2-}}$}\" display=\"block\">\n  <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{Hg}{\\vphantom{A}}^{2+} {}\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}{} \\underset{\\mathrm{red}}{\\ce{HgI2}}  {}\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}{} \\underset{\\mathrm{red}}{\\ce{[Hg^{II}I4]^2-}} }\">\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n      <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n    </mrow>\n    <msup data-latex=\"{\\vphantom{A}}^{2+}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n          <mpadded width=\"0\">\n            <mphantom>\n              <mi data-latex=\"A\">A</mi>\n            </mphantom>\n          </mpadded>\n        </mrow>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2+}\">\n        <mn data-latex=\"2\">2</mn>\n        <mo data-latex=\"+\">+</mo>\n      </mrow>\n    </msup>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}\">\n      <mover data-latex=\"\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{I}\">\n            <mi mathvariant=\"normal\" data-latex=\"I\">I</mi>\n          </mrow>\n          <msup data-latex=\"{\\vphantom{A}}^{-}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </msup>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </mover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <munder data-latex=\"\\underset{\\mathrm{red}}{\\ce{HgI2}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{HgI}{\\vphantom{A}}_{\\smash[t]{2}}}\">\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{HgI}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"HgI\">HgI</mi>\n        </mrow>\n        <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{2}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{2}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{2}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"2\">2</mn>\n              </mpadded>\n            </mrow>\n          </mrow>\n        </msub>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{red}\">\n        <mi data-mjx-auto-op=\"false\" data-latex=\"red\">red</mi>\n      </mrow>\n    </munder>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <mrow data-mjx-texclass=\"REL\" data-latex=\"\\mathrel{\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}}\">\n      <mover data-latex=\"\\xrightarrow{\\mathrm{I}{\\vphantom{A}}^{-}}\">\n        <mstyle scriptlevel=\"0\">\n          <mo data-mjx-texclass=\"REL\">&#x2192;</mo>\n        </mstyle>\n        <mpadded width=\"+0.833em\" lspace=\"0.278em\" voffset=\"-.2em\" height=\"-.2em\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{I}\">\n            <mi mathvariant=\"normal\" data-latex=\"I\">I</mi>\n          </mrow>\n          <msup data-latex=\"{\\vphantom{A}}^{-}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n              <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n                <mpadded width=\"0\">\n                  <mphantom>\n                    <mi data-latex=\"A\">A</mi>\n                  </mphantom>\n                </mpadded>\n              </mrow>\n            </mrow>\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"{-}\">\n              <mo data-latex=\"-\">&#x2212;</mo>\n            </mrow>\n          </msup>\n          <mspace depth=\".2em\"></mspace>\n        </mpadded>\n      </mover>\n    </mrow>\n    <mrow data-mjx-texclass=\"ORD\" data-latex=\"{}\"></mrow>\n    <munder data-latex=\"\\underset{\\mathrm{red}}{\\ce{[Hg^{II}I4]^2-}}\">\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"{[\\mathrm{Hg}{\\vphantom{A}}^{\\mathrm{II}}\\mathrm{I}{\\vphantom{A}}_{\\smash[t]{4}}]{\\vphantom{A}}^{2-}}\">\n        <mo data-latex=\"[\" stretchy=\"false\">[</mo>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{Hg}\">\n          <mi data-mjx-auto-op=\"false\" data-latex=\"Hg\">Hg</mi>\n        </mrow>\n        <msup data-latex=\"{\\vphantom{A}}^{\\mathrm{II}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\mathrm{II}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{II}\">\n              <mi data-mjx-auto-op=\"false\" data-latex=\"II\">II</mi>\n            </mrow>\n          </mrow>\n        </msup>\n        <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{I}\">\n          <mi mathvariant=\"normal\" data-latex=\"I\">I</mi>\n        </mrow>\n        <msub data-latex=\"{\\vphantom{A}}_{\\smash[t]{4}}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\smash[t]{4}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\smash[t]{4}\">\n              <mpadded height=\"0\">\n                <mn data-latex=\"4\">4</mn>\n              </mpadded>\n            </mrow>\n          </mrow>\n        </msub>\n        <mo data-latex=\"]\" stretchy=\"false\">]</mo>\n        <msup data-latex=\"{\\vphantom{A}}^{2-}\">\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{\\vphantom{A}}\">\n            <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\vphantom{A}\">\n              <mpadded width=\"0\">\n                <mphantom>\n                  <mi data-latex=\"A\">A</mi>\n                </mphantom>\n              </mpadded>\n            </mrow>\n          </mrow>\n          <mrow data-mjx-texclass=\"ORD\" data-latex=\"{2-}\">\n            <mn data-latex=\"2\">2</mn>\n            <mo data-latex=\"-\">&#x2212;</mo>\n          </mrow>\n        </msup>\n      </mrow>\n      <mrow data-mjx-texclass=\"ORD\" data-latex=\"\\mathrm{red}\">\n        <mi data-mjx-auto-op=\"false\" data-latex=\"red\">red</mi>\n      </mrow>\n    </munder>\n  </mrow>\n</math>"
  ));
})
