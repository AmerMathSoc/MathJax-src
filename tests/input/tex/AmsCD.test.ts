import { beforeEach, describe, it } from '@jest/globals';
import { toXmlMatch } from '../../src/xmlMatch';
import { setupTex, tex2mml } from '../../src/setupTex';

beforeEach(() => setupTex(['base', 'amscd']));

describe('AmsCD', () => {
  it('AmsCD-1', () =>
    toXmlMatch(
      tex2mml('\\begin{CD}A @>a>> B\\\\@VVbV @VVcV\\\\C @>d>> D\\end{CD}'),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="a">a</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mrow>\n          <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{b}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{b}">\n              <mpadded width="0">\n                <mi data-latex="b">b</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mrow>\n          <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{c}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{c}">\n              <mpadded width="0">\n                <mi data-latex="c">c</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="C">C</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="d">d</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="D">D</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-2', () =>
    toXmlMatch(
      tex2mml('\\begin{CD}A @<<< B @>>> C\\\\@. @| @AAA\\\\@. D @= E\\end{CD}'),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\begin{CD}A @&lt;&lt;&lt; B @&gt;&gt;&gt; C\\\\@. @| @AAA\\\\@. D @= E\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\begin{CD}A @&lt;&lt;&lt; B @&gt;&gt;&gt; C\\\\@. @| @AAA\\\\@. D @= E\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2190;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="C">C</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd></mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" stretchy="true" symmetric="true" lspace="0" rspace="0">&#x2225;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2191;</mo>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mi data-latex="D">D</mi>\n      </mtd>\n      <mtd>\n        <mo minsize="2.75em" stretchy="true">=</mo>\n      </mtd>\n      <mtd>\n        <mi data-latex="E">E</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-3', () =>
    toXmlMatch(
      tex2mml('\\begin{CD}A @>a>b> B\\\\@VlVrV @AlArA\\\\C @<a<b< D\\end{CD}'),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\begin{CD}A @&gt;a&gt;b&gt; B\\\\@VlVrV @AlArA\\\\C @&lt;a&lt;b&lt; D\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\begin{CD}A @&gt;a&gt;b&gt; B\\\\@VlVrV @AlArA\\\\C @&lt;a&lt;b&lt; D\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <munderover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em">\n            <mi data-latex="b">b</mi>\n          </mpadded>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="a">a</mi>\n          </mpadded>\n        </munderover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mrow>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\llap{l}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\llap{l}">\n              <mpadded width="0" lspace="-1width">\n                <mi data-latex="l">l</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n          <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{r}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{r}">\n              <mpadded width="0">\n                <mi data-latex="r">r</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mrow>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\llap{l}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\llap{l}">\n              <mpadded width="0" lspace="-1width">\n                <mi data-latex="l">l</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n          <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2191;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{r}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{r}">\n              <mpadded width="0">\n                <mi data-latex="r">r</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="C">C</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <munderover>\n          <mo minsize="2.75em">&#x2190;</mo>\n          <mpadded width="+.67em" lspace=".33em">\n            <mi data-latex="b">b</mi>\n          </mpadded>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="a">a</mi>\n          </mpadded>\n        </munderover>\n      </mtd>\n      <mtd>\n        <mi data-latex="D">D</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-4', () =>
    toXmlMatch(
      tex2mml(
        '\\begin{CD}A @>>> B@>\\text{very long label}>>C\\\\@VVV @VVV @VVV\\\\D @>>> E@>>> F\\end{CD}'
      ),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\begin{CD}A @&gt;&gt;&gt; B@&gt;\\text{very long label}&gt;&gt;C\\\\@VVV @VVV @VVV\\\\D @&gt;&gt;&gt; E@&gt;&gt;&gt; F\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\begin{CD}A @&gt;&gt;&gt; B@&gt;\\text{very long label}&gt;&gt;C\\\\@VVV @VVV @VVV\\\\D @&gt;&gt;&gt; E@&gt;&gt;&gt; F\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mtext data-latex="\\text{very long label}">very long label</mtext>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="C">C</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="D">D</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="E">E</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="F">F</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-5', () =>
    toXmlMatch(
      tex2mml(
        '\\begin{CD}A @>>> B @>{\\text{very long label}}>> C \\\\@VVV @VVV @VVV \\\\D @>>> E @>{\\phantom{\\text{very long label}}}>> F\\end{CD}'
      ),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\begin{CD}A @&gt;&gt;&gt; B @&gt;{\\text{very long label}}&gt;&gt; C \\\\@VVV @VVV @VVV \\\\D @&gt;&gt;&gt; E @&gt;{\\phantom{\\text{very long label}}}&gt;&gt; F\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\begin{CD}A @&gt;&gt;&gt; B @&gt;{\\text{very long label}}&gt;&gt; C \\\\@VVV @VVV @VVV \\\\D @&gt;&gt;&gt; E @&gt;{\\phantom{\\text{very long label}}}&gt;&gt; F\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mrow data-mjx-texclass="ORD" data-latex="{\\text{very long label}}">\n              <mtext data-latex="\\text{very long label}">very long label</mtext>\n            </mrow>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="C">C</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="D">D</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="E">E</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mrow data-mjx-texclass="ORD" data-latex="{\\phantom{\\text{very long label}}}">\n              <mrow data-mjx-texclass="ORD" data-latex="\\phantom{\\text{very long label}}">\n                <mphantom>\n                  <mtext data-latex="\\text{very long label}">very long label</mtext>\n                </mphantom>\n              </mrow>\n            </mrow>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="F">F</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-6', () =>
    toXmlMatch(
      tex2mml(
        '\\begin{CD}A @>>> B @>{\\text{very long label}}>> C \\\\@VVV @VVV @VVV \\\\D @>>> E @>{\\rlap{\\scriptstyle{\\ \\ \\ \\text{shorter}}}\\phantom{\\text{very long label}}}>> F\\end{CD}'
      ),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\begin{CD}A @&gt;&gt;&gt; B @&gt;{\\text{very long label}}&gt;&gt; C \\\\@VVV @VVV @VVV \\\\D @&gt;&gt;&gt; E @&gt;{\\rlap{\\scriptstyle{\\ \\ \\ \\text{shorter}}}\\phantom{\\text{very long label}}}&gt;&gt; F\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\begin{CD}A @&gt;&gt;&gt; B @&gt;{\\text{very long label}}&gt;&gt; C \\\\@VVV @VVV @VVV \\\\D @&gt;&gt;&gt; E @&gt;{\\rlap{\\scriptstyle{\\ \\ \\ \\text{shorter}}}\\phantom{\\text{very long label}}}&gt;&gt; F\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mrow data-mjx-texclass="ORD" data-latex="{\\text{very long label}}">\n              <mtext data-latex="\\text{very long label}">very long label</mtext>\n            </mrow>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="C">C</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="D">D</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mspace width="2.75em" linebreak="nobreak" data-latex="\\kern 2.75em"></mspace>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="E">E</mi>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mrow data-mjx-texclass="ORD" data-latex="{\\rlap{\\scriptstyle{\\ \\ \\ \\text{shorter}}}\\phantom{\\text{very long label}}}">\n              <mrow data-mjx-texclass="ORD" data-latex="\\rlap{\\scriptstyle{\\ \\ \\ \\text{shorter}}}">\n                <mpadded width="0">\n                  <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle{\\ \\ \\ \\text{shorter}}">\n                    <mrow data-mjx-texclass="ORD" data-latex="{\\text{shorter}}">\n                      <mtext>&#xA0;</mtext>\n                      <mtext>&#xA0;</mtext>\n                      <mtext>&#xA0;</mtext>\n                      <mtext data-latex="\\text{shorter}">shorter</mtext>\n                    </mrow>\n                  </mstyle>\n                </mpadded>\n              </mrow>\n              <mrow data-mjx-texclass="ORD" data-latex="\\phantom{\\text{very long label}}">\n                <mphantom>\n                  <mtext data-latex="\\text{very long label}">very long label</mtext>\n                </mphantom>\n              </mrow>\n            </mrow>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="F">F</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-width', () =>
    toXmlMatch(
      tex2mml(
        '\\minCDarrowwidth{5cm}\\begin{CD}A @>a>> B\\\\@VVbV @VVcV\\\\C @>d>> D\\end{CD}'
      ),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\minCDarrowwidth{5cm}\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\minCDarrowwidth{5cm}\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="5cm">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="a">a</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mrow>\n          <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{b}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{b}">\n              <mpadded width="0">\n                <mi data-latex="b">b</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mrow>\n          <mo minsize="1.75em" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{c}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{c}">\n              <mpadded width="0">\n                <mi data-latex="c">c</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="C">C</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="5cm">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="d">d</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="D">D</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-height', () =>
    toXmlMatch(
      tex2mml(
        '\\minCDarrowheight{4cm}\\begin{CD}A @>a>> B\\\\@VVbV @VVcV\\\\C @>d>> D\\end{CD}'
      ),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\minCDarrowheight{4cm}\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\minCDarrowheight{4cm}\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="a">a</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mrow>\n          <mo minsize="4cm" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{b}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{b}">\n              <mpadded width="0">\n                <mi data-latex="b">b</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mrow>\n          <mo minsize="4cm" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{c}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{c}">\n              <mpadded width="0">\n                <mi data-latex="c">c</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="C">C</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="2.75em">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="d">d</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="D">D</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
  it('AmsCD-both', () =>
    toXmlMatch(
      tex2mml(
        '\\minCDarrowheight{4cm}\\minCDarrowwidth{5cm}\\begin{CD}A @>a>> B\\\\@VVbV @VVcV\\\\C @>d>> D\\end{CD}'
      ),
      '<math xmlns="http://www.w3.org/1998/Math/MathML" data-latex="\\minCDarrowheight{4cm}\\minCDarrowwidth{5cm}\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}" display="block">\n  <mtable columnspacing="5pt" rowspacing="5pt" displaystyle="true" data-latex-item="{CD}" data-latex="\\minCDarrowheight{4cm}\\minCDarrowwidth{5cm}\\begin{CD}A @&gt;a&gt;&gt; B\\\\@VVbV @VVcV\\\\C @&gt;d&gt;&gt; D\\end{CD}">\n    <mtr>\n      <mtd>\n        <mi data-latex="A">A</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="5cm">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="a">a</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="B">B</mi>\n      </mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mrow>\n          <mo minsize="4cm" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{b}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{b}">\n              <mpadded width="0">\n                <mi data-latex="b">b</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n      <mtd>\n        <mrow>\n          <mo minsize="4cm" symmetric="true" lspace="0" rspace="0">&#x2193;</mo>\n          <mstyle displaystyle="false" scriptlevel="1" data-latex="\\scriptstyle\\rlap{c}">\n            <mrow data-mjx-texclass="ORD" data-latex="\\rlap{c}">\n              <mpadded width="0">\n                <mi data-latex="c">c</mi>\n              </mpadded>\n            </mrow>\n          </mstyle>\n        </mrow>\n      </mtd>\n      <mtd></mtd>\n    </mtr>\n    <mtr>\n      <mtd>\n        <mi data-latex="C">C</mi>\n        <mpadded height="8.5pt" depth="2pt"></mpadded>\n      </mtd>\n      <mtd>\n        <mover>\n          <mo minsize="5cm">&#x2192;</mo>\n          <mpadded width="+.67em" lspace=".33em" voffset=".1em">\n            <mi data-latex="d">d</mi>\n          </mpadded>\n        </mover>\n      </mtd>\n      <mtd>\n        <mi data-latex="D">D</mi>\n      </mtd>\n    </mtr>\n  </mtable>\n</math>'
    ));
});
